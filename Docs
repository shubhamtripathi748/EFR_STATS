CALL FetchDataByDateRange('2024-01-01', '2024-01-31');

DELIMITER //

CREATE PROCEDURE FetchDataByDateRange(
    IN start_date DATE,
    IN end_date DATE
)
BEGIN
    WITH CTE_Table1 AS (
        SELECT 
            column1 AS t1_col1,
            column2 AS t1_col2,
            date_column AS t1_date
        FROM 
            table1
        WHERE 
            date_column BETWEEN start_date AND end_date
    ),
    
    CTE_Table2 AS (
        SELECT 
            column3 AS t2_col1,
            column4 AS t2_col2,
            date_column AS t2_date
        FROM 
            table2
        WHERE 
            date_column BETWEEN start_date AND end_date
    ),
    
    CombinedData AS (
        SELECT 
            t1.t1_col1,
            t1.t1_col2,
            t1.t1_date,
            t2.t2_col1,
            t2.t2_col2,
            t2.t2_date
        FROM 
            CTE_Table1 t1
        JOIN 
            CTE_Table2 t2 ON t1.t1_date = t2.t2_date
    )
    
    SELECT * FROM CombinedData;
    
END //

DELIMITER ;




DELIMITER //

CREATE PROCEDURE FetchDataByDateRange(
    IN start_date DATE,
    IN end_date DATE
)
BEGIN
    WITH CombinedData AS (
        SELECT 
            table1.*, 
            table2.*
        FROM 
            table1
        JOIN 
            table2 ON table1.common_column = table2.common_column  -- Replace with the actual common column
        WHERE 
            table1.date_column BETWEEN start_date AND end_date
            AND table2.date_column BETWEEN start_date AND end_date
    )
    
    SELECT * FROM CombinedData;
    
END //

DELIMITER ;
